webpackJsonp([4],{"/eR5":function(e,n,t){"use strict";function r(e){function n(){return a}function r(n){var t=o(e,n);return a.push(t),t}e.inputs=t.i(i.a)();var a=[];return function(){var e=c.a.getQS().get("i0");if(e){var n=r(0);n.link=e,n.updateBinding(!0)}}(),{getInputs:n,addInput:r}}function o(e,n){function r(e){i&&(clearTimeout(i),i=null),e?o():i=setTimeout(o,300)}function o(){u.error=null,i=null;var r=t.i(a.a)(e,u.link,{done:function(){c.a.getQS().set("i"+n,u.link)},error:function(e){u.error=e}});e.inputs.bindInput(0,r)}var i=null,u={link:"",error:null,name:"input"+n,updateBinding:r};return u}n.a=r;var i=t("n67P"),a=(t("p2DF"),t("I6d+")),c=t("NEgR")},"2PgA":function(e,n,t){function r(e,n){function t(){var e=Object.create(null),n=window.location.search;n&&(e=Object.assign(e,i.parse(n.substr(1))));var t=window.location.hash;t&&(e=Object.assign(e,i.parse(t.substr(2)))),r(e)}function r(e){var n=p+i.stringify(e);window.history?window.history.replaceState(void 0,void 0,n):window.location.replace(n)}function a(e){if("function"!=typeof e)throw new Error("changeCallback needs to be a function");0===f.length&&window.addEventListener("hashchange",u,!1),f.push(e)}function c(){0!==f.length&&(f=[],window.removeEventListener("hashchange",u,!1))}function u(){s(d())}function s(e){for(var n=0;n<f.length;++n){(0,f[n])(e)}}function d(){var e=l?window.location.search:window.location.hash,n=(e||p).substr(p.length);return i.parse(n)}if("undefined"==typeof window)return o(e);var f=[],l=n&&n.useSearch,p=l?"?":"#?";return n.rewriteHashToSearch&&t(),function(){var n=d(),t=!1;"object"==typeof e&&e&&Object.keys(e).forEach(function(r){r in n||(n[r]=e[r],t=!0)}),t&&r(n)}(),{onChanged:a,dispose:c,set:r,get:d,rewriteHashToSearch:t}}e.exports=r;var o=t("5hi0"),i=t("9XuS")},"3xg8":function(e,n,t){"use strict";function r(e){function n(n){v.setCustomVectorField(n);var t=v.getFragmentShader(),r=v.getVertexShader(),o=i.a.createProgram(_,r,t);h&&h.unload(),h=o,e.colorMode===c.a.VELOCITY&&w.requestSpeedUpdate()}function r(n,r){y=e.particleStateResolution;var o=[{name:"x",particleState:n},{name:"y",particleState:r}];g&&g.dispose(),g=t.i(s.a)(_,o,y),m&&m.dispose(),m=t.i(s.a)(_,o,y),w.updateParticlesCount()}function a(n){e.colorMode===c.a.VELOCITY&&w.setColorMinMax(n),g.bindTextures(_,n)}function f(){var n=h;_.useProgram(n.program),i.a.bindAttribute(_,e.quadBuffer,n.a_pos,2),e.inputs.updateBindings(n),e.audioTexture&&(i.a.bindTexture(_,e.audioTexture,5),_.uniform1i(n.u_audio,5)),g.bindTextures(_,n),_.uniform1f(n.u_rand_seed,e.frameSeed),_.uniform1f(n.u_h,e.integrationTimeStep),_.uniform1f(n.frame,e.frame);var t=e.cursor;_.uniform4f(n.cursor,t.clickX,t.clickY,t.hoverX,t.hoverY);var r=e.bbox;_.uniform2f(n.u_min,r.minX,r.minY),_.uniform2f(n.u_max,r.maxX,r.maxY),_.uniform1f(n.u_drop_rate,e.dropProbability);for(var o=0;o<m.length;++o){var a=m.get(o);_.uniform1i(n.u_out_coordinate,o),i.a.bindFramebuffer(_,e.framebuffer,a.texture),_.viewport(0,0,y,y),_.drawArrays(_.TRIANGLES,0,6)}e.colorMode===c.a.VELOCITY&&w.updateParticlesPositions(n),b&&(x(n),b=null);var u=g;g=m,m=u}function l(e){b=e}function x(n){var r=[{name:"x",particleState:b.x},{name:"y",particleState:b.y}],a=b.resolution,c=a*a,u=t.i(s.a)(_,r,a),f=t.i(s.a)(_,r,a);u.bindTextures(_,n);var l=f.get(0);_.uniform1i(n.u_out_coordinate,6),i.a.bindFramebuffer(_,e.framebuffer,l.texture),_.viewport(0,0,a,a),_.drawArrays(_.TRIANGLES,0,6);var v=new Uint8Array(4*c);_.readPixels(0,0,a,a,_.RGBA,_.UNSIGNED_BYTE,v),_.uniform1i(n.u_out_coordinate,7),l=f.get(1),i.a.bindFramebuffer(_,e.framebuffer,l.texture),_.viewport(0,0,a,a),_.drawArrays(_.TRIANGLES,0,6);var x=new Uint8Array(4*c);_.readPixels(0,0,a,a,_.RGBA,_.UNSIGNED_BYTE,x),f.dispose(),u.dispose();for(var g=t.i(d.a)(),m=t.i(d.a)(),y=new Float32Array(c),h=new Float32Array(c),w=0;w<x.length;w+=4){var E=w/4,T=o(v,w),P=o(x,w);y[E]=T,h[E]=P,g.add(T),m.add(P)}var C={xStats:g,yStats:m,decoded_velocity_x:y,decoded_velocity_y:h,resolution:a};p.a.fire("vector-line-ready",C)}var g,m,y,h,b,_=e.gl,w=t.i(u.a)(e);return p.a.on("vector-lines-request",l),{updateCode:n,updateParticlesPositions:f,updateParticlesCount:r,prepareToDraw:a}}function o(e,n){return t.i(f.b)(e[n+0],e[n+1],e[n+2],e[n+3])}n.a=r;var i=t("Ddjs"),a=t("Qv35"),c=t("6c6E"),u=t("gIFv"),s=t("pXNl"),d=t("V39N"),f=t("FaU1"),l=t("eBcr"),p=t.n(l),v=new a.a},"4KA4":function(e,n,t){"use strict";var r=t("Zrlr"),o=t.n(r),i=t("wxAW"),a=t.n(i),c=function(){function e(){o()(this,e)}return a()(e,[{key:"getDefines",value:function(){return""}},{key:"getFunctions",value:function(){return""}},{key:"getMainBody",value:function(){return""}}]),e}();n.a=c},"5hi0":function(e,n){function t(e){function n(){return c}function t(e){c=e,setTimeout(function(){i(e)},0)}function r(){a=[]}function o(e){if("function"!=typeof e)throw new Error("changeCallback should be a function");a.push(e)}function i(e){a.forEach(function(n){n(e)})}var a=[],c=e;return{dispose:r,onChanged:o,set:t,get:n}}e.exports=t},"6c6E":function(e,n,t){"use strict";n.a={UNIFORM:1,VELOCITY:2,ANGLE:3,CUSTOM:4}},"7QEO":function(e,n,t){"use strict";n.a=[{name:"Secret door",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:1,cx:-.15344999999999986,cy:-.1291,w:7.4611,h:7.4611,code:"// p.x and p.y are current coordinates\n  // v.x and v.y is a velocity at point p\n  vec2 get_velocity(vec2 p) {\n    vec2 v = vec2(0., 0.);\n\n    // change this to get a new vector field\n    v.x = p.y*p.y ;\n    v.y = -p.x*p.x *.05;\n\n    return v;\n  }"},{name:"Miserables graph with edges",timeStep:-.001,fadeOut:.998,dropProbability:.008,colorMode:2,cx:.467,cy:1.5294,w:.9368,h:.9368,showBindings:1,i0:"https://gist.githubusercontent.com/anvaka/ebc18e3ffe05b0709a7ae933261fa2e9/raw/bafb63d01e0ab37c1f9b51522a5ec4fbc19bc4f1/edges.png",code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  vec4 c = texture2D(input0, vec2(mod(p.x,1.), 1. - mod(p.y, 1.)));\n  v.x = (c.r + c.g/255.) - 0.5;\n  v.y = 0.5 - (c.b + c.a/255.);\n\n  if (length(v) < 0.1) v = vec2(0.);\n  return (v);\n}",particleCount:4e4},{name:"Roads",timeStep:.001,fadeOut:.998,dropProbability:.009,colorMode:2,cx:.478,cy:.2636,w:.9922,h:.9922,showBindings:0,i0:"https://gist.githubusercontent.com/anvaka/ebc18e3ffe05b0709a7ae933261fa2e9/raw/cd7d82c5a235f50f5655ac94aa9077709731adde/binary_tree.png",code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  vec4 c = texture2D(input0, vec2(mod(p.x,1.), 1. - mod(p.y, 1.)));\n  v.x = (c.r + c.g/255.) - 0.5;\n  v.y = 0.5 - (c.b + c.a/255.);\n\n  return (v);\n}",particleCount:4e4},{name:"Four counterclockwise cogs pushing particles clockwise :)",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:1,cx:.7887499999999994,cy:-.5769500000000001,w:16.3759,h:16.3759,code:"vec2 field(vec2 p) {\n  float d = length(p);\n  return vec2(-p.y, p.x) * exp(-d*d*0.1);\n}\n// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  v = field(p + vec2(-5., 0.)) +\n    field(p + vec2(-2.5, 2.5)) +\n    field(p + vec2(0., 0.)) +\n    field(p + vec2(-2.5, -2.5));\n  return v;\n}"},{name:"Waveshaping [interactive]",cx:0,cy:-.060899999999999954,w:12,h:12,timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:2,code:"float f(float x) {\n  bool supportsHover = length(cursor.zw) > 0.01;\n  vec2 c = supportsHover ? cursor.zw : cursor.xy;\n  float f1 = sin(x);\n  float f2 = sin(2.*x);\n  float f3 = sin(3.*x);\n  float f4 = sin(4.*x);\n  float f5 = sin(5.*x);\n  return f1 +\n    f2*c.x/4. +\n    f3*c.y/6. +\n    f4*c.x/8. +\n    f5*c.y/10.;\n}\n\nfloat df(float x) {\n  float h = 0.001;\n  return (f(x+h)-f(x-h))/(2.*h);\n}\n\n\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  float fx = f(p.x);\n  float d = abs(p.y-fx);\n  float dfx = df(p.x);\n  vec2 toOrigin = -p/(20.*length(p));\n  vec2 toF = 0.1*vec2(0.,fx-p.y);\n  v = d < 0.1 ? vec2(1.,dfx) : toF;\n  return v;\n}",particleCount:5e4},{name:"Hex plane [interactive]",timeStep:.01,fadeOut:.99,dropProbability:.99,colorMode:3,cx:0,cy:0,w:8.5398,h:8.5398,code:"vec2 nearest(vec2 p) {\n// Charles Chambers black hex magic\nfloat temp = floor(p.x + sqrt(3.) * p.y + 1.);\nfloat q = floor((floor(2.*p.x+1.) + temp) / 3.);\nfloat r = floor((temp + floor(-p.x + sqrt(3.) * p.y + 1.))/3.);\nreturn vec2(q-p.y/2.,r-p.y/8.);\n}\n\n// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n  float f = frame/1000.;\n  float z = (3.-p.y)/(6.+cursor.zw.y*2.);\n  float a = cursor.zw.x;\n  vec2 r = vec2(cos(a)*p.x - sin(a)*p.y,sin(a)*p.x+cos(a)*p.y);\n  vec2 t = vec2(r.x / z, r.y / z);\n  vec2 n = nearest(t);\n  v.x = t.x-n.x;\n  v.y = t.y-n.y;\n  return v;\n}",particleCount:5e5},{name:"Rain",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:1,cx:0,cy:0,w:8.5398,h:8.5398,code:"bool isUnshadowed(vec2 p) {\n  bool upper = length(p) > 1.0 && p.y > 0.0;\n  bool lower = length(p) > 1.0 && p.y < 0.0 && abs(p.x) > 1.0;\n  return upper || lower;\n}\n\nvec2 unshadowedV(vec2 p) {\n  return vec2(0.0,-3.0+p.y);\n}\n\nbool isSpray(vec2 p) {\n  return length(p) > 1.0 && abs(p.x) < 1.0;\n}\n\nvec2 sprayV(vec2 p) {\n  float vy = -1.0+p.y;\n  float vx = p.x > 0.0 ? (1.0-p.x)/vy : (-1.0-p.x)/vy;\n  return vec2(vx,vy);\n}\n\nbool isCircle(vec2 p) {\n  return length(p) > 1.0 && length(p) < 1.05;\n}\n\nvec2 circleV(vec2 p) {\n  vec2 v = vec2(0., 0.);\n  v.x = sign(p.x)* p.y;\n  v.y = -abs(p.x);\n  return v;\n}\n\n// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  v = isCircle(p) ? circleV(p) :\n      isUnshadowed(p) ? unshadowedV(p) :\n      isSpray(p) ? sprayV(p) : vec2(1.0/0.0,1.0/0.0);\n\n  return v;\n}",particleCount:1e4},{name:"Mouse-driven Julia Set",timeStep:.01,fadeOut:.9,dropProbability:.009,colorMode:3,cx:-.27144999999999997,cy:.14175000000000004,w:6.120699999999999,h:6.120699999999999,particleCount:1e6,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float a = cursor.zw.x;\nfloat b = cursor.zw.y;\nfloat sx = p.x/2.0;\nfloat sy = p.y/2.0;\nfloat i1x = sx*sx - sy*sy+a;\nfloat i1y = -2.0*sx*sy+b;\nfloat i2x = i1x*i1x - i1y*i1y+a;\nfloat i2y = -2.0*i1x*i1y+b;\nfloat i3x = i2x*i2x - i2y*i2y+a;\nfloat i3y = -2.0*i2x*i2y+b;\nfloat i4x = i3x*i3x - i3y*i3y+a;\nfloat i4y = -2.0*i3x*i3y+b;\nfloat i5x = i4x*i4x - i4y*i4y+a;\nfloat i5y = -2.0*i4x*i4y+b;\nfloat i6x = i5x*i5x - i5y*i5y+a;\nfloat i6y = -2.0*i5x*i5y+b;\nfloat i7x = i6x*i6x - i6y*i6y+a;\nfloat i7y = -2.0*i6x*i6y+b;\nfloat i8x = i7x*i7x - i7y*i7y+a;\nfloat i8y = -2.0*i7x*i7y+b;\nfloat i9x = i8x*i8x - i8y*i8y+a;\nfloat i9y = -2.0*i8x*i8y+b;\n\n  float n = sqrt(i9x*i9x+i9y*i9y);\n\nv.x = n > 2.0 ? -p.x/10.0 : p.x/10.0;\nv.y = n > 2.0 ? -p.y/10.0 : p.y/10.0;\n\n  return v;\n}"},{name:"Hyperjump",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:2,cx:.523299999999999,cy:1.2703999999999995,w:48.3842,h:48.3842,code:"vec2 circle(vec2 p, vec2 c) {\n  vec2 c0 = p - c;\n  vec2 p0 = vec2(-c0.y, c0.x);\n  float l = length(p0);\n  return p0 * exp(-l*sin(frame*0.01));\n}\n// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = circle(p, vec2(0., 0.));\n\n  float r = 7.;\n  for (int i = 0; i < 2; ++i) {\n    float a = 0.01 * frame + float(i) * 2.*PI/7.;\n    v += circle(p, vec2(r * cos(a) , r * sin(a)));\n  }\n  return v;\n}",particleCount:3e4},{name:"Particle Grinder",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:1,cx:.028149999999999675,cy:.08830000000000005,w:9.045300000000001,h:9.045300000000001,code:"vec2 tensor(vec2 p, vec2 c0, vec4 abcd, float N) {\n  vec2 p0 = p - c0;\n  float theta = atan(p0.y, p0.x);\n  float c = cos(N * theta);\n  float s = sin(N * theta);\n  return length(p0) * vec2(abcd[2] * c + abcd[3] * s,\n              abcd[0] * c + abcd[1] * s);\n}\n\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n  v = tensor(p, vec2(0., 0.), vec4(-2., 0., 0., 1.), 2.);\n  return v;\n}"},{name:"Hyperbolic flux [interactive]",timeStep:.001,fadeOut:.999,dropProbability:.009,colorMode:3,cx:-.11990000000000034,cy:.018899999999999917,w:8.5442,h:8.5442,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  float ax = (cursor.zw.x - p.x);\n  float ay = (cursor.zw.y - p.y);\n  float al = sqrt(ax*ax+ay*ay);\n\n  float rx = (p.x-cursor.xy.x);\n  float ry = (p.y-cursor.xy.y);\n  float rl = sqrt(rx*rx+ry*ry);\n\n  // change this to get a new vector field\n  v.x = (ax*ax*ry + ay*rx*rx)/(al*rl);\n  v.y = (ay*ay*rx + ax*ry*ry)/(al*rl);\n\n  return v;\n}",particleCount:1e6},{name:"Swim against the current",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:3,cx:3.0524500000000003,cy:-1.3792,w:8.5397,h:8.5397,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float dx1 = cursor.zw.x - p.x;\nfloat dy1 = cursor.zw.y - p.y;\nfloat dl1 = sqrt(dx1*dx1+dy1*dy1);\ndx1 = dx1/dl1;\ndy1 = dy1/dl1;\n\nfloat dx2 = cursor.xy.x - p.x;\nfloat dy2 = cursor.xy.y - p.y;\nfloat dl2 = sqrt(dx2*dx2+dy2*dy2);\ndx2 = dx2/dl2;\ndy2 = dy2/dl2;\n\nfloat fx = cursor.xy.x - cursor.zw.x;\nfloat fy = cursor.xy.y - \ncursor.zw.y;\nfloat fl = sqrt(fx*fx+fy*fy);\nfx = -fx/fl;\nfy = -fy/fl;\n\nfloat d1 = (dx1*fx + dy1*fy)/(dl1*fl);\nfloat d2 = 1.-d1;\nv.x = d1*fx+d2*dx2;\nv.y = d1*fy+d2*dy2;\n\n  return v;\n}",particleCount:100900},{name:"Eye of Sauron (interactive)",timeStep:.01,fadeOut:.988,dropProbability:.008,colorMode:2,cx:.3991000000000007,cy:-.11315000000000008,w:37.0984,h:37.0984,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  // calculate distortion map (reverse solver)\n// the distortion map is based on a sphere, but smoothed to the ends: sqrt(1-(x^8/(x^8-1))^(1/4))\n\nfloat dist_radius = 7.8;\nvec2 distortion = cursor.zw;\nif (length(distortion) > 4.5) {\n    distortion = normalize(distortion) *4.5;\n}\n\n// iterative reverse algo. after all, we knew the result position already, we're trying to reason back to what the original position was\nvec2 d = p;\nfor (int i = 0; i < 10; i++) {\n    // calculate distortion effect magnitude\n    float d_scale = pow(length(d) / dist_radius, 8.);\n    // pseudo sphere map\n    d_scale = pow(1. - pow(d_scale / (d_scale + 1.), .25), .5);\n    d = p - distortion * d_scale;\n}\n\n// calculate differentials, working backwards (i.e. what change in p would result from a change in d)\nvec2 d_dx  = d + vec2(0.1, 0.0);\nfloat d_dx_scale = pow(length(d_dx) / dist_radius, 8.);\nd_dx_scale = pow(1. - pow(d_dx_scale / (d_dx_scale + 1.), .25), .5);\nvec2 dx = (d_dx + distortion * d_dx_scale - p) / 0.1;\n\nvec2 d_dy  = d + vec2(0.0, 0.1);\nfloat d_dy_scale = pow(length(d_dy) / dist_radius, 8.);\nd_dy_scale = pow(1. - pow(d_dy_scale / (d_dy_scale + 1.), .25), .5);\nvec2 dy = (d_dy + distortion * d_dy_scale - p) / 0.1;\n\n// center parts\nfloat pupilrange = length(vec2(d.y, d.x + 6.*sign(d.x)));\nvec2 pupilborder = 2.6*vec2(-d.y, (d.x + 6.*sign(d.x)) );\nv += pupilborder * smoothstep(6.6, 6.8, pupilrange) * (1. - smoothstep(6.9, 7.1, pupilrange));\n\nfloat range = length(d);\nvec2 iris = 7.*d/sqrt(range);\nv += iris * smoothstep(7.0, 7.5, pupilrange) * (1. - smoothstep(3.8, 4.0, range));\n\nvec2 pupil = 1.*vec2(d.x+1.*sign(d.x), d.y);\nv += pupil * (1. - smoothstep(6.6, 6.8, pupilrange));\n\n// absolute parts\nvec2 psign = sign(d);\nvec2 a = abs(d);\nvec2 vabs = vec2(0.0, 0.0);\n\nfloat borderrange = length(vec2(d.x, d.y + 7.*sign(d.y)));\nvec2 border = -1.5*vec2(a.y + 7.*sign(a.y) - 3./(a.y + 1.), -a.x + 3./(a.x + 1.));\nvabs += border * smoothstep(10.8, 11.25, borderrange) * (1. - smoothstep(11.25, 11.7, borderrange)) * smoothstep(3.8, 4.1, range) * (a.y / (a.y + 1.));\n\nvec2 irisborder = 5.*vec2(a.y, -a.x) * (a.y / (a.y + 3.))+ .2 * a;\nvabs += irisborder * smoothstep(3.8, 4.25, range) * (1. - smoothstep(4.25, 4.7, range));\n\nvec2 white = 12.*vec2(1.0, -0.2 * (a.y));\nvabs += white * smoothstep(4.3, 4.5, range) * (1. - smoothstep(11., 11.3, borderrange));\n\nv += vabs * psign;\n\n// outside part\nvec2 outside = d / pow(borderrange - 10., 2.);\nv -= outside * smoothstep(11.3, 11.5, borderrange);\n\n// velocity distortion mapping\nv = v.x * dx + v.y * dy;\n\n// color mapping\nif (length(v) > 0.01) {\n    v = normalize(v) * 10.;\n}\nv = v / (1. + 0.1 * (borderrange - 10.) * smoothstep(11.5, 12.5, borderrange));\n\n\n\n  return v;\n}",particleCount:3e4},{name:"Combination of two fields. One follows cursor",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:1,cx:0,cy:0,w:8.5398,h:8.5398,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  vec2 p1 = p - vec2(-2., 0.);\nvec2 p2 = p - cursor.zw;\n\nfloat l1 = length(p1), l2 = length(p2);\n\nv = vec2(-p1.y, p1.x)/(l1 * l1) + vec2(-p2.y, p2.x)/(l2 * l2);\n\n  return v;\n}"},{name:"[Randomized] nice symmetry",timeStep:.01,fadeOut:.988,dropProbability:.008,colorMode:2,cx:-2.6390499999999992,cy:-1.1419499999999996,w:46.508700000000005,h:46.508700000000005,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  v.x = p.y/cos(length(p));\n  v.y = max((log(p.y)+p.x),p.x);\n\n  return v;\n}",particleCount:2e4},{name:"A city block from a parallel Universe (by @MananG_8)",timeStep:.01,fadeOut:.988,dropProbability:.008,colorMode:1,cx:.6165500000000002,cy:-1.87745,w:9.0455,h:9.0455,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  v.x = sin(tan(p.x))*cos(tan(p.y));\n  v.y = sin(tan(p.y))*cos(tan(p.x));\n\n  return v;\n}\n",particleCount:2e4},{name:"â™¥ by @SAKrisT",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:2,cx:-1.4246499999999997,cy:.92285,w:8.5397,h:8.5397,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float size = 1.0;\n  vec2 o = (p)/(1.6* size);\n  float a = o.x*o.x+o.y*o.y-0.3;\n  v = vec2(step(a*a*a, o.x*o.x*o.y*o.y*o.y));\n\n  return v;\n}\n"},{name:"Dynamic vector field by Evgeniy Andreev. Not defined by physical system, but beautiful.",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:3,cx:-1.6564499999999995,cy:-.36424999999999974,w:24.7317,h:24.7317,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float dt = 0.01;\n  float t = frame*dt;\n  float w = 2.*PI/5.;\n  float A = 2.;\n\n  float d = sqrt(p.x*p.x + p.y*p.y);\n  v.x = A*cos(w*t/d);\n  v.y = A*sin(w*t/d);\n\n  return v;\n}",particleCount:3e3},{name:"Behold (by /u/censored_username)",timeStep:.01,fadeOut:.988,dropProbability:.008,colorMode:2,cx:.12704999999999966,cy:.1923499999999998,w:22.5709,h:22.5709,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float x = abs(p.x) - 5.;\n  float side = sign(p.x);\n  float range = length(vec2(x, p.y));\n  float irisrange = length(vec2(x, p.y + 2.*sign(p.y)));\n\n  vec2 border = 1.*vec2(p.y + 2.2*sign(p.y) * (p.y*p.y / (p.y*p.y + 0.01)), -x);\n\n  vec2 outside = vec2(x / (1.+10./abs(p.x*p.x)), p.y);\n\n  vec2 spiral = vec2(p.y, -x);\n\n  vec2 iris = sin(-range * 10.) * spiral + 0.05*vec2(x, p.y);\n\n  v += outside * (smoothstep(4.0, 4.5, irisrange)/range*5. - 5.*smoothstep(0.9, 0.7, range)/range);\n  v += border * smoothstep(3.5, 4., irisrange) * smoothstep(4.5, 4., irisrange);\n  v += iris * smoothstep(2.0, 1.5, range) * smoothstep(0.8, 1., range);\n  v -= 10.0*spiral * smoothstep(1.0, 0.8, range) * smoothstep(0.7, 0.9, range);\n\n  v.x *= side;\n  v *= -1.;\n\n  return v;\n}",particleCount:3e4}]},"7UaU":function(e,n,t){function r(e,n){function t(e,n){g.on("change",e,n)}function r(e,n){g.off("change",e,n)}function o(){return p}function u(){p.dispose(),g.off()}function s(e){return void 0===e?v:v[e]}function d(e,n){var t=typeof e;return"object"===t?Object.keys(e).forEach(function(n){v[n]=e[n]}):"string"===t&&(v[e]=n),p.set(v),x}function f(e){v=e,g.fire("change",v)}function l(e,n){if("object"==typeof e&&Object.keys(e).forEach(function(n){n in v||(v[n]=e[n])}),!(e in v))return v[e]=n,p.set(v),x}n=n||{};var p=n.history||c(e,n);i(p),p.onChanged(f);var v=p.get()||Object.create(null),x={get:s,set:d,setIfEmpty:l,dispose:u,onChange:t,offChange:r,getHistoryObject:o},g=a({});return x}function o(e){return u?e&&u.setIfEmpty(e):u=r(e),u}function i(e){if(!e)throw new Error("history is required");if("function"!=typeof e.dispose)throw new Error("dispose is required");if("function"!=typeof e.onChanged)throw new Error("onChanged is required")}e.exports=r;var a=t("fkI9"),c=t("2PgA");r.instance=o;var u},"85ps":function(e,n,t){"use strict";function r(e){return t.i(s.a)(e).then(function(n){if(n.error)return n;e=n.getCode();var t=d.check(e,{globals:f});return t.code=e,t.log.errorCount&&(t.error=o(t.log)),t})}function o(e){var n=e.diagnostics[0],t=n.range,r=t.lineColumn(),o=t.source,c=o._lineOffsets[r.line],u=o.contents.substr(c,r.column);u+=o.contents.substring(t.start,t.end);var s="Line "+r.line+": ",d=n.text;return{error:s+u+"\n"+a(s.length)+a(r.column)+"^",errorDetail:d,isFloatError:i(d)}}function i(e){return e.indexOf('"int"')>-1&&e.indexOf('"float"')>-1}function a(e){return new Array(e+1).join(" ")}n.a=r;var c=t("eBcr"),u=t.n(c),s=t("svlg"),d={check:function(e){return{code:e,log:{errorCount:0}}}};t.e(2).then(function(){d=t("TFw8"),u.a.fire("glsl-parser-ready")}.bind(null,t)).catch(t.oe);var f="\nimport {\n  float PI;\n  float snoise(vec2 v);\n  float frame;\n  vec4 cursor;\n  vec2 rotate(vec2 p,float a);\n  float audio(float index);\n  float rand(const vec2 co);\n  sampler2D input0;\n  sampler2D input1;\n}"},"94y8":function(e,n,t){"use strict";function r(e){function n(){i.a.off("audio",r),o.deleteTexture(u)}function t(){if(s){s=!1;o.bindTexture(o.TEXTURE_2D,u),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,5,5,0,o.RGBA,o.UNSIGNED_BYTE,c),o.bindTexture(o.TEXTURE_2D,null)}}function r(e){c=e,s=!0}var o=e.gl,c=new Uint8Array(256),u=a.a.createTexture(o,o.NEAREST,c,8,8),s=!1;return e.audioTexture=u,i.a.on("audio",r),{updateTextures:t,dispose:n}}var o=t("eBcr"),i=t.n(o),a=t("Ddjs");n.a=r},"9XuS":function(e,n){function t(e){function n(n){var t=e[n],r=i(n);return void 0!==t&&(r+="="+o(t)),r}return e?Object.keys(e).map(n).join("&"):""}function r(e){function n(e){if(e){var n=e.split("=");t[decodeURIComponent(n[0])]=c(n[1])}}var t=Object.create(null);return e?(e.split("&").forEach(n),t):t}function o(e){return e instanceof Date&&(e=e.toISOString()),i(e)}function i(e){return encodeURIComponent(e).replace(/[()]/g,a)}function a(e){return")"===e?"%29":"("===e?"%28":e}function c(e){return e=decodeURIComponent(e),""===e?e:isNaN(e)?u(e)?"true"===e:s(e)?new Date(e):e:parseFloat(e)}function u(e){return"true"===e||"false"===e}function s(e){return e&&e.match(/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/)}e.exports={parse:r,stringify:t}},C8nW:function(e,n,t){"use strict";function r(e,n){function t(t,r){function o(e){e.lengthComputable&&n.progress({loaded:e.loaded,total:e.total,percent:e.loaded/e.total})}function i(){if(200!==u.status)return void r("Unexpected status code "+u.status+" when calling "+e);var o=u.response;"json"===n.responseType&&"string"==typeof o&&(o=JSON.parse(o)),t(o)}function a(){r("Failed to download "+e)}function c(){r("Cancelled download of "+e)}var u=new XMLHttpRequest;"function"==typeof n.progress&&u.addEventListener("progress",o,!1),u.addEventListener("load",i,!1),u.addEventListener("error",a,!1),u.addEventListener("abort",c,!1),u.open("GET",e),n.responseType&&(u.responseType=n.responseType),u.send(null)}return n||(n={}),new i.a(t)}n.a=r;var o=t("//Fk"),i=t.n(o)},Ddjs:function(e,n,t){"use strict";function r(e,n,t){e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,n)}function o(e,n){var t=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW),t}function i(e,n,t,r,o){var i=e.createTexture();return e.bindTexture(e.TEXTURE_2D,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,n),t instanceof Uint8Array?e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r,o,0,e.RGBA,e.UNSIGNED_BYTE,t):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.bindTexture(e.TEXTURE_2D,null),i}function a(e,n,t){e.bindFramebuffer(e.FRAMEBUFFER,n),t&&e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}function c(e,n,t,r){e.bindBuffer(e.ARRAY_BUFFER,n),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,r,e.FLOAT,!1,0,0)}function u(e,n,t){function r(){e.deleteProgram(o)}var o=e.createProgram(),i=s(e,e.VERTEX_SHADER,n),a=s(e,e.FRAGMENT_SHADER,t);if(e.attachShader(o,i),e.attachShader(o,a),e.linkProgram(o),!e.getProgramParameter(o,e.LINK_STATUS))throw new Error(e.getProgramInfoLog(o));var c,u={program:o,unload:r},d=e.getProgramParameter(o,e.ACTIVE_ATTRIBUTES);for(c=0;c<d;c++){var f=e.getActiveAttrib(o,c);u[f.name]=e.getAttribLocation(o,f.name)}var l=e.getProgramParameter(o,e.ACTIVE_UNIFORMS);for(c=0;c<l;c++){var p=e.getActiveUniform(o,c);u[p.name]=e.getUniformLocation(o,p.name)}return u}function s(e,n,t){var r=e.createShader(n);if(e.shaderSource(r,t),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))throw new Error(e.getShaderInfoLog(r));return r}n.a={createTexture:i,bindFramebuffer:a,createProgram:u,createBuffer:o,bindAttribute:c,bindTexture:r}},DuZ1:function(e,n,t){"use strict";var r=t("Zx67"),o=t.n(r),i=t("Zrlr"),a=t.n(i),c=t("wxAW"),u=t.n(c),s=t("zwoO"),d=t.n(s),f=t("Pf15"),l=t.n(f),p=t("4KA4"),v=t("JjDM"),x=t("bvb0"),g=function(e){function n(e){a()(this,n);var t=d()(this,(n.__proto__||o()(n)).call(this));return t.updateCode=e||"",t}return l()(n,e),u()(n,[{key:"setNewUpdateCode",value:function(e){this.updateCode=e}},{key:"getDefines",value:function(){return"\nuniform float frame;\nuniform vec4 cursor;\n// TODO: use inputN instead.\nuniform sampler2D u_audio;\n\n#define PI 3.1415926535897932384626433832795\n\n"+t.i(x.a)()+"\n"}},{key:"getFunctions",value:function(){return"\n    // pseudo-random generator\nconst vec3 rand_constants = vec3(12.9898, 78.233, 4375.85453);\nfloat rand(const vec2 co) {\n    float t = dot(rand_constants.xy, co);\n    return fract(sin(t) * (rand_constants.z + t));\n}\n\n"+v.a+"\n\nvec2 rotate(vec2 p,float a) {\n\treturn cos(a)*p+sin(a)*vec2(p.y,-p.x);\n}\n\n// TODO: This will change. Don't use it.\nfloat audio(float index) {\n  float rgbI = floor(index/4.);\n  vec2 txPos = vec2(fract(rgbI / 5.), floor(rgbI / 5.) / 5.);\n  vec4 rgba = texture2D(u_audio, txPos);\n  \n  float offset = mod(index, 4.);\n  if (offset == 0.) return rgba[0];\n  if (offset == 1.) return rgba[1];\n  if (offset == 2.) return rgba[2];\n  return rgba[3];\n}\n\n"+(this.updateCode?this.updateCode:"vec2 get_velocity(vec2 p) { return vec2(0.); }")+"\n  "}}]),n}(p.a);n.a=g},FaU1:function(e,n,t){"use strict";function r(e,n,t){if(0==e)return n[t+0]=0,n[t+1]=0,n[t+2]=0,void(n[t+3]=0);var r=Math.abs(e),o=Math.floor(c()(r));o+=i(o)<=r/2?1:0,o-=i(o)>r?1:0;var a;a=o>100?r/1024/i(o-10)-1:r/i(o)-1;var u=o+127;a*=256;var s=Math.floor(a);a-=s,a*=256;var d=Math.floor(a);a-=d,a*=128;var f=2*Math.floor(a)+(e<0?1:0);n[t+0]=u,n[t+1]=s,n[t+2]=d,n[t+3]=f}function o(e,n,t,r){var o=Math.floor(e+.5),a=Math.floor(n+.5),c=Math.floor(t+.5),u=Math.floor(r+.5),s=o-127;return(1-u%2*2)*((o>0?1:0)+a/256+c/65536+Math.floor(u/2)/8388608)*i(s)}function i(e){return Math.exp(e*Math.LN2)}n.a=r,n.b=o;var a=t("yI0F"),c=t.n(a)},"I6d+":function(e,n,t){"use strict";function r(e,n,r){function a(e){r&&r.error&&r.error(e)}function c(e){f=e,u.a.fire("refresh-speed"),r&&r.done&&r.done(n)}function d(n,t){if(f){var r=t+s;i.a.bindTexture(e.gl,f,r),e.gl.uniform1i(n["input"+t],r)}}var f=null;return t.i(o.a)(e.gl,n).then(c).catch(a),{updateBinding:d,dispose:function(){e.gl.deleteTexture(f)}}}n.a=r;var o=t("egvE"),i=t("Ddjs"),a=t("rvz5"),c=t("eBcr"),u=t.n(c),s=a.a.FREE_TEXTURE_UNIT},JHsM:function(e,n,t){"use strict";function r(e){function n(e){if(e){var n=s()({},Z.bbox);if(r(e,"minX",n),r(e,"minY",n),r(e,"maxX",n),r(e,"maxY",n),void 0!==e.minY||void 0!==e.maxY){var t=Math.abs(n.minY-n.maxY)/Math.abs(Z.bbox.minY-Z.bbox.maxY),o=(Z.bbox.maxX+Z.bbox.minX)/2,i=(Z.bbox.maxX-Z.bbox.minX)/2;n.minX=o-i*t,n.maxX=o+i*t}L(n)}}function r(e,n,t){var r=c()(e[n]);i()(r)&&(t[n]=r)}function o(e){G=e}function a(){G=null}function u(e){var n=parseInt(e,10);x.a.setColorMode(n),Z.colorMode=x.a.getColorMode(),Q.updateColorMode(n)}function f(){return x.a.getColorMode()}function p(){return x.a.getIntegrationTimeStep()}function w(e){var n=parseFloat(e);i()(n)&&(Z.integrationTimeStep=n,x.a.setIntegrationTimeStep(n),v.a.fire("integration-timestep-changed",n))}function E(e){H=e,B()}function T(e){var n=parseFloat(e);i()(n)&&(Z.fadeOpacity=n,x.a.setFadeout(n))}function P(){return x.a.getFadeout()}function C(){return x.a.getParticleCount()}function S(e){i()(e)&&e!==q&&(e<1||(U(e),q=e,x.a.setParticleCount(e)))}function M(e){var n=parseFloat(e);i()(n)&&(x.a.setDropProbability(n),Z.dropProbability=n)}function A(){return x.a.getDropProbability()}function R(){F(window.innerWidth,window.innerHeight),J.updateScreenTextures(),N(V)}function F(n,t){var r=Math.max(.02*n,30),o=Math.max(.02*t,30);z.width=n+2*r,z.height=t+2*o,z.top=-o,z.left=-r;var i=e.canvas;i.width=z.width,i.height=z.height,i.style.left=-r+"px",i.style.top=-o+"px"}function D(){I(),te.dispose(),window.removeEventListener("resize",R,!0),$.dispose(),ee.dispose()}function B(){W||H||(W=requestAnimationFrame(X))}function I(){cancelAnimationFrame(W),W=0}function X(){W=0,O(),G&&G.capture(e.canvas),B()}function O(){J.fadeOutLastFrame(),Q.drawParticles(),J.renderCurrentScreen(),Q.updateParticlesPositions()}function U(e){Z.particleStateResolution=Math.ceil(Math.sqrt(e)),Q.updateParticlesCount()}function k(){var e=x.a.getBBox(),n=z.width,t=z.height,r=Math.PI*Math.E,o=Math.PI*Math.E,i=0,a=0;e&&(r=e.maxX-e.minX,o=e.maxY-e.minY,i=n*(e.minX+e.maxX)/2,a=n*(e.minY+e.maxY)/2);var c=r*n/2,u=o*t/2;te.showRectangle({left:-c+i,top:-u-a,right:c+i,bottom:u-a})}function N(e){function n(n){return(n-e.x)/e.scale}function t(n){return(n-e.y)/e.scale}J.boundingBoxUpdated=!0,V.x=e.x,V.y=e.y,V.scale=e.scale;var r=z.width,o=z.height,i=n(0),a=t(0),c=n(r),u=t(o),s=1e4;j.minX=Math.round(s*i/r)/s,j.minY=Math.round(s*-a/r)/s,j.maxX=Math.round(s*c/r)/s,j.maxY=Math.round(s*-u/r)/s,x.a.saveBBox(j),v.a.fire("bbox-change",j)}function Y(){var e=Math.PI*Math.E*.5,n=Math.PI*Math.E*.5;L({minX:-e,minY:-n,maxX:e,maxY:n})}function L(e){x.a.saveBBox(e,!0),k(),te.moveBy(0,0,!1)}var z={width:0,height:0,top:0,left:0};F(e.canvas.width,e.canvas.height),window.addEventListener("resize",R,!0),v.a.on("start-record",o),v.a.on("stop-record",a);var G=null,j=x.a.getBBox()||{},V={scale:1,x:0,y:0},q=x.a.getParticleCount();e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST);var W,Z={gl:e,bbox:j,canvasRect:z,inputs:null,framebuffer:e.createFramebuffer(),quadBuffer:d.a.createBuffer(e,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1])),colorMode:x.a.getColorMode(),colorFunction:x.a.getColorFunction(),screenTextureUnit:3,integrationTimeStep:x.a.getIntegrationTimeStep(),dropProbability:x.a.getDropProbability(),frame:0,cursor:{clickX:0,clickY:0,hoverX:0,hoverY:0},particleStateResolution:0,fadeOpacity:x.a.getFadeout(),audioTexture:null},H=!1,K=t.i(_.a)(Z),J=t.i(m.a)(Z),Q=t.i(y.a)(Z),$=t.i(h.a)(Z),ee=t.i(b.a)(Q);U(q);var ne={start:B,stop:I,dispose:D,resetBoundingBox:Y,moveBoundingBox:n,setPaused:E,getParticlesCount:C,setParticlesCount:S,setFadeOutSpeed:T,getFadeOutSpeed:P,setDropProbability:M,getDropProbability:A,getIntegrationTimeStep:p,setIntegrationTimeStep:w,setColorMode:u,getColorMode:f,vectorFieldEditorState:ee,inputsModel:K,getCanvasRect:function(){return z},getBoundingBox:function(){return Z.bbox}},te=function(){return l()(e.canvas,{realPinch:!0,zoomSpeed:.025,controller:t.i(g.a)(e.canvas,N)})}();return k(),setTimeout(function(){v.a.fire("scene-ready",ne)}),ne}n.a=r;var o=t("AMV0"),i=t.n(o),a=t("5dBV"),c=t.n(a),u=t("woOf"),s=t.n(u),d=t("Ddjs"),f=t("yBIK"),l=t.n(f),p=t("eBcr"),v=t.n(p),x=t("NEgR"),g=t("p0IO"),m=t("h62Y"),y=t("pKWO"),h=t("p9aJ"),b=t("c5hq"),_=t("/eR5")},JjDM:function(e,n,t){"use strict";n.a="\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 mod289(vec2 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 permute(vec3 x) {\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat snoise(vec2 v)\n  {\n  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n                     -0.577350269189626,  // -1.0 + 2.0 * C.x\n                      0.024390243902439); // 1.0 / 41.0\n// First corner\n  vec2 i  = floor(v + dot(v, C.yy) );\n  vec2 x0 = v -   i + dot(i, C.xx);\n\n// Other corners\n  vec2 i1;\n  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n  //i1.y = 1.0 - i1.x;\n  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n  // x0 = x0 - 0.0 + 0.0 * C.xx ;\n  // x1 = x0 - i1 + 1.0 * C.xx ;\n  // x2 = x0 - 1.0 + 2.0 * C.xx ;\n  vec4 x12 = x0.xyxy + C.xxzz;\n  x12.xy -= i1;\n\n// Permutations\n  i = mod289(i); // Avoid truncation effects in permutation\n  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\n\t\t+ i.x + vec3(0.0, i1.x, 1.0 ));\n\n  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n  m = m*m ;\n  m = m*m ;\n\n// Gradients: 41 points uniformly over a line, mapped onto a diamond.\n// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\n\n  vec3 x = 2.0 * fract(p * C.www) - 1.0;\n  vec3 h = abs(x) - 0.5;\n  vec3 ox = floor(x + 0.5);\n  vec3 a0 = x - ox;\n\n// Normalise gradients implicitly by scaling m\n// Approximation of: m *= inversesqrt( a0*a0 + h*h );\n  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n// Compute final noise value at P\n  vec3 g;\n  g.x  = a0.x  * x0.x  + h.x  * x0.y;\n  g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n  return 130.0 * dot(m, g);\n}\n"},NEgR:function(e,n,t){"use strict";function r(){var e=B.get("cm");return w(e)?e:O.colorMode}function o(e){w(e)&&(B.set({cm:e}),I.cm=e)}function i(){return B.get("cf")||""}function a(e){B.set({cf:e}),I.cf=e}function c(){var e=B.get("fo");return w(e)?e:O.fadeout}function u(e){w(e)&&(B.set({fo:e}),I.fo=e)}function s(){var e=B.get("pc");return w(e)?e:O.particleCount}function d(e){w(e)&&(B.set({pc:e}),I.pc=e)}function f(){var e=B.get("dt");return w(e)?e:O.timeStep}function l(e){w(e)&&(B.set({dt:e}),I.dt=e)}function p(){var e=B.get("dp");return w(e)?e:O.dropProbability}function v(e){w(e)&&(E(e,0,1),B.set({dp:e}))}function x(){return g(B.get("cx"),B.get("cy"),B.get("w"),B.get("h"))}function g(e,n,t,r){if(w(e)&&w(n)&&w(t)&&w(r)){var o=t/2,i=r/2,a=1e4;return{minX:Math.round(a*(e-o))/a,maxX:Math.round(a*(e+o))/a,minY:Math.round(a*(n-i))/a,maxY:Math.round(a*(n+i))/a}}}function m(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];T&&(clearTimeout(T),T=0),n?y(e):T=setTimeout(function(){return y(e)},300)}function y(e){T=0;var e={cx:.5*(e.minX+e.maxX),cy:.5*(e.minY+e.maxY),w:e.maxX-e.minX,h:e.maxX-e.minX};e.w<=0||e.h<=0||(B.set(e),I.cx=e.cx,I.cy=e.cy,I.w=e.w,I.h=e.h)}function h(){var e=B.get("vf");if(e)return e;var n=B.get("code");return n?(e=t.i(D.a)(n),delete I.code,B.set("vf",e),e):X}function b(){return X}function _(e){B.set({vf:e}),I.code=e}function w(e){return C()(e)}function E(e,n,t){return e<n?n:e>t?t:e}var T,P=t("AMV0"),C=t.n(P),S=t("7UaU"),M=t.n(S),A=t("eBcr"),R=t.n(A),F=t("6c6E"),D=t("cj2E"),B=M()({},{useSearch:!0,rewriteHashToSearch:!0}),I=B.get(),X=t.i(D.a)("v.x = 0.1 * p.y;\n  v.y = -0.2 * p.y;"),O={timeStep:.01,dropProbability:.009,particleCount:1e4,fadeout:.998,colorMode:F.a.UNIFORM},U={collapsed:window.innerWidth<600};n.a={settingsPanel:U,saveBBox:m,getBBox:x,makeBBox:g,getQS:function(){return B},saveCode:_,getCode:h,getDefaultCode:b,getDropProbability:p,setDropProbability:v,getIntegrationTimeStep:f,setIntegrationTimeStep:l,getParticleCount:s,setParticleCount:d,getFadeout:c,setFadeout:u,getColorMode:r,setColorMode:o,getColorFunction:i,setColorFunction:a},B.onChange(function(){R.a.fire("scene-ready",window.scene)})},Qv35:function(e,n,t){"use strict";var r=t("Zx67"),o=t.n(r),i=t("zwoO"),a=t.n(i),c=t("Pf15"),u=t.n(c),s=t("Zrlr"),d=t.n(s),f=t("wxAW"),l=t.n(f),p=t("4KA4"),v=t("XMEc"),x=t("S+/9"),g=t("DuZ1"),m=t("vhRe"),y=t("i69e"),h=function(){function e(n){d()(this,e),this.readStoredPosition=new v.a(!0),this.udfVelocity=new g.a,this.integratePositions=new y.a,this.dropParticles=new b,this.writeComputedPosition=new v.a(!1),this.panZoomDecode=new m.a({decode:!0}),this.panZoomEncode=new m.a({decode:!1}),this.colorMode=n&&n.colorMode}return l()(e,[{key:"setCustomVectorField",value:function(e){this.udfVelocity.setNewUpdateCode(e)}},{key:"getVertexShader",value:function(){return"precision highp float;\n\nattribute vec2 a_pos;\nvarying vec2 v_tex_pos;\nuniform vec2 u_min;\nuniform vec2 u_max;\n\nvoid main() {\n    v_tex_pos = a_pos;\n    gl_Position = vec4(1.0 - 2.0 * a_pos, 0, 1);\n}"}},{key:"getFragmentShader",value:function(){var e=[this.readStoredPosition,this.dropParticles,this.udfVelocity,this.integratePositions,{getMainBody:function(){return"\n  vec2 newPos = pos + velocity;\n  "}},this.writeComputedPosition];return t.i(x.a)(e)}}]),e}();n.a=h;var b=function(e){function n(){return d()(this,n),a()(this,(n.__proto__||o()(n)).apply(this,arguments))}return u()(n,e),l()(n,[{key:"getDefines",value:function(){return"\nuniform float u_drop_rate;\nuniform float u_rand_seed;\nuniform vec2 u_min;\nuniform vec2 u_max;\n"}},{key:"getFunctions",value:function(){return"\n"}},{key:"getMainBody",value:function(){return"\n  // a random seed to use for the particle drop\n  vec2 seed = (pos + v_tex_pos) * u_rand_seed;\n  // drop rate is a chance a particle will restart at random position, to avoid degeneration\n  float drop = step(1.0 - u_drop_rate, rand(seed));\n\n  // TODO: This can be customized to produce various emitters\n  // random_pos is in range from 0..1, we move it to the bounding box:\n  vec2 random_pos = vec2(rand(seed + 1.9), rand(seed + 8.4)) * (u_max - u_min) + u_min;\n  pos = mix(pos, random_pos, drop);\n"}}]),n}(p.a)},"S+/9":function(e,n,t){"use strict";function r(e){function n(e){e&&t.push(e)}var t=[];return e.forEach(function(e){e.getDefines&&n(e.getDefines())}),e.forEach(function(e){e.getFunctions&&n(e.getFunctions())}),n("void main() {"),e.forEach(function(e){e.getMainBody&&n(e.getMainBody())}),n("}"),t.join("\n")}n.a=r},V39N:function(e,n,t){"use strict";function r(){function e(){n=Number.POSITIVE_INFINITY,t=Number.NEGATIVE_INFINITY}var n,t;return{getMin:function(){return n},getMax:function(){return t},add:function(e){e<n&&(n=e),e>t&&(t=e)},reset:e}}n.a=r},XFig:function(e,n,t){"use strict";n.a="\nhighp float decodeFloatRGBA( vec4 v ) {\n  float a = floor(v.r * 255.0 + 0.5);\n  float b = floor(v.g * 255.0 + 0.5);\n  float c = floor(v.b * 255.0 + 0.5);\n  float d = floor(v.a * 255.0 + 0.5);\n\n  float exponent = a - 127.0;\n  float sign = 1.0 - mod(d, 2.0)*2.0;\n  float mantissa = float(a > 0.0)\n                  + b / 256.0\n                  + c / 65536.0\n                  + floor(d / 2.0) / 8388608.0;\n  return sign * mantissa * exp2(exponent);\n}\n"},XMEc:function(e,n,t){"use strict";var r=t("Zx67"),o=t.n(r),i=t("Zrlr"),a=t.n(i),c=t("wxAW"),u=t.n(c),s=t("zwoO"),d=t.n(s),f=t("Pf15"),l=t.n(f),p=t("4KA4"),v=t("a8s+"),x=t("XFig"),g=function(e){function n(e){a()(this,n);var t=d()(this,(n.__proto__||o()(n)).call(this));return t.isDecode=e,t}return l()(n,e),u()(n,[{key:"getFunctions",value:function(){if(this.isDecode)return"\n    "+v.a+"\n    "+x.a+"\n"}},{key:"getDefines",value:function(){if(this.isDecode)return"\nprecision highp float;\n\nuniform sampler2D u_particles_x;\nuniform sampler2D u_particles_y;\n\n// Which coordinate needs to be printed onto the texture\nuniform int u_out_coordinate;\n\nvarying vec2 v_tex_pos;\n"}},{key:"getMainBody",value:function(){return this.isDecode?"\n   vec2 pos = vec2(\n     decodeFloatRGBA(texture2D(u_particles_x, v_tex_pos)),\n     decodeFloatRGBA(texture2D(u_particles_y, v_tex_pos))\n   );\n":"\n    if (u_out_coordinate == 0) gl_FragColor = encodeFloatRGBA(newPos.x);\n    else if (u_out_coordinate == 1) gl_FragColor = encodeFloatRGBA(newPos.y);\n    else if (u_out_coordinate == 6) gl_FragColor = encodeFloatRGBA(get_velocity(pos).x);\n    else if (u_out_coordinate == 7) gl_FragColor = encodeFloatRGBA(get_velocity(pos).y);\n"}}]),n}(p.a);n.a=g},YJWA:function(e,n,t){"use strict";function r(e){if(!f)return void t.e(1).then(function(){f=t("nI+d"),window.stopRecord=i,r(e)}.bind(null,t)).catch(t.oe);if(l&&l.stop(),!o()){var n=document.createElement("script");return n.setAttribute("src",e||"http://localhost:8080/ffmpegserver/ffmpegserver.js"),n.onload=function(){return r(e)},void document.head.appendChild(n)}l=new f({format:"ffmpegserver",framerate:60,verbose:!0,name:"fieldplay",extension:".mp4",codec:"mpeg4",ffmpegArguments:["-b:v","12M"]}),window.isRecording=!0,l.start(),u.a.fire("start-record",l)}function o(){return"undefined"!=typeof FFMpegServer}function i(){window.isRecording=!1,u.a.fire("stop-record",l),l.stop(),l.save()}Object.defineProperty(n,"__esModule",{value:!0});var a=t("JHsM"),c=t("eBcr"),u=t.n(c),s=t("sbZs"),d=document.getElementById("scene");d&&function(e){e.width=window.innerWidth,e.height=window.innerHeight;var n={antialiasing:!1},r=e.getContext("webgl",n)||e.getContext("experimental-webgl",n);if(r){window.webGLEnabled=!0;var o=t.i(a.a)(r);o.start(),t.i(s.a)(o),window.scene=o}else window.webGLEnabled=!1}(d),t.e(0).then(function(){t("WOBu")}.bind(null,t)).catch(t.oe);var f,l;window.startRecord=r,window.isRecording=!1},"a8s+":function(e,n,t){"use strict";n.a="\nvec4 encodeFloatRGBA(highp float val) {\n    if (val == 0.0) {\n        return vec4(0.0, 0.0, 0.0, 0.0);\n    }\n\n    float mag = abs(val);\n    float exponent = floor(log2(mag));\n    // Correct log2 approximation errors.\n    exponent += float(exp2(exponent) <= mag / 2.0);\n    exponent -= float(exp2(exponent) > mag);\n\n    float mantissa;\n    if (exponent > 100.0) {\n        // Not sure why this needs to be done in two steps for the largest float to work.\n        // Best guess is the optimizer rewriting '/ exp2(e)' into '* exp2(-e)',\n        // but exp2(-128.0) is too small to represent.\n        mantissa = mag / 1024.0 / exp2(exponent - 10.0) - 1.0;\n    } else {\n        mantissa = mag / float(exp2(exponent)) - 1.0;\n    }\n\n    float a = exponent + 127.0;\n    mantissa *= 256.0;\n    float b = floor(mantissa);\n    mantissa -= b;\n    mantissa *= 256.0;\n    float c = floor(mantissa);\n    mantissa -= c;\n    mantissa *= 128.0;\n    float d = floor(mantissa) * 2.0 + float(val < 0.0);\n    return vec4(a, b, c, d) / 255.0;\n}\n"},aZPT:function(e,n,t){"use strict";function r(e,n){e.getMethods&&n.push(e.getMethods())}function o(e,n){e.getMain&&n.push(e.getMain())}function i(){function e(){return"\nuniform sampler2D u_particles_x;\nuniform sampler2D u_particles_y;\n    "}function n(){return"\n  vec2 v_particle_pos = vec2(\n    decodeFloatRGBA(texture2D(u_particles_x, txPos)),\n    decodeFloatRGBA(texture2D(u_particles_y, txPos))\n  );\n"}return{getVariables:e,getMain:n}}var a=t("Zrlr"),c=t.n(a),u=t("wxAW"),s=t.n(u),d=t("XFig"),f=t("c5NW"),l=function(){function e(n){c()(this,e),this.colorMode=n.colorMode,this.colorFunction=n.colorFunction||""}return s()(e,[{key:"getFragmentShader",value:function(){return"precision highp float;\nvarying vec4 v_particle_color;\nvoid main() {\n  gl_FragColor = v_particle_color;\n}"}},{key:"getVertexShader",value:function(e){var n=i(),a=t.i(f.a)(this.colorMode,e,this.colorFunction),c=[];r(n,c),r(a,c);var u=[];return o(n,u),o(a,u),"precision highp float;\nattribute float a_index;\nuniform float u_particles_res;\nuniform vec2 u_min;\nuniform vec2 u_max;\n\n"+(n.getVariables()||"")+"\n"+a.getVariables()+"\n\n"+d.a+"\n\n"+c.join("\n")+"\n\nvoid main() {\n  vec2 txPos = vec2(\n        fract(a_index / u_particles_res),\n        floor(a_index / u_particles_res) / u_particles_res);\n  gl_PointSize = 1.0;\n\n"+u.join("\n")+"\n\n  vec2 du = (u_max - u_min);\n  v_particle_pos = (v_particle_pos - u_min)/du;\n  gl_Position = vec4(2.0 * v_particle_pos.x - 1.0, (1. - 2. * (v_particle_pos.y)),  0., 1.);\n}"}}]),e}();n.a=l},bvb0:function(e,n,t){"use strict";function r(){return"uniform sampler2D input0;\nuniform sampler2D input1;"}n.a=r},c5NW:function(e,n,t){"use strict";function r(e,n,t){function r(){return"\nuniform vec2 u_velocity_range;\nvarying vec4 v_particle_color;\n\n"+d.getDefines()+"\n"+f.getDefines()+"\n"}function c(){return"\n// https://github.com/hughsk/glsl-hsv2rgb\nvec3 hsv2rgb(vec3 c) {\n  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n"+d.getFunctions()+"\n"+f.getFunctions()+"\n"+u()+"\n"}function u(){if(e===a.a.UNIFORM)return"\nvec4 get_color(vec2 p) {\n  return vec4(0.302, 0.737, 0.788, 1.);\n}\n";if(e===a.a.VELOCITY)return"\nvec4 get_color(vec2 p) {\n  vec2 velocity = get_velocity(p);\n  float speed = (length(velocity) - u_velocity_range[0])/(u_velocity_range[1] - u_velocity_range[0]);\n  return vec4(hsv2rgb(vec3(0.05 + (1. - speed) * 0.5, 0.9, 1.)), 1.0);\n}\n";if(e===a.a.CUSTOM){if(!t)throw new Error("color mode is set to custom, but no color function is specified");return t}return" \nvec4 get_color(vec2 p) {\n  vec2 velocity = get_velocity(p);\n  float speed = (atan(velocity.y, velocity.x) + PI)/(2.0 * PI);\n  return vec4(hsv2rgb(vec3(speed, 0.9, 1.)), 1.0);\n}\n"}function s(){return"  v_particle_color = get_color(v_particle_pos);"}var d=new o.a(n),f=new i.a;return{getVariables:r,getMain:s,getMethods:c}}n.a=r;var o=t("DuZ1"),i=t("i69e"),a=t("6c6E")},c5hq:function(e,n,t){"use strict";function r(e){function n(){i.a.off("glsl-parser-ready",s)}function r(){return a.a.getCode()}function o(e){if(e===p)return void(f&&f.error&&s());d(e).then(function(n){if(!n.cancelled){if(n&&n.error)return u(n.error),n;p=e,v.code=e,a.a.saveCode(e)}})}function u(e){e&&e.error?(v.error=e.error,v.errorDetail=e.errorDetail,v.isFloatError=e.isFloatError):(v.error="",v.errorDetail="",v.isFloatError=!1)}function s(e){return t.i(c.a)(e||p).then(function(e){return f=e,u(f.error),f})}function d(n){l+=1;var t=l;return s(n).then(function(n){if(t!==l)return n.cancelled=!0,n;if(n.error)return n;try{return e.updateCode(n.code),n}catch(e){return{error:{error:e.message}}}})}i.a.on("glsl-parser-ready",s);var f,l=0,p=a.a.getCode();!function(){var e=a.a.getCode();e?d(e).then(function(e){e.error&&(console.error("Failed to restore previous vector field: ",e.error),d(a.a.getDefaultCode()))}):d(a.a.getDefaultCode())}();var v={getCode:r,setCode:o,dispose:n,code:p,error:"",errorDetail:"",isFloatError:!1};return v}n.a=r;var o=t("eBcr"),i=t.n(o),a=t("NEgR"),c=t("85ps")},cj2E:function(e,n,t){"use strict";function r(e){return"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  "+e+"\n\n  return v;\n}"}n.a=r},eBcr:function(e,n,t){var r=t("puH/");e.exports=r({})},egvE:function(e,n,t){"use strict";function r(e,n){function t(e){c(e)}function r(){var n=e.createTexture(),t=e.RGBA,r=e.RGBA,a=e.UNSIGNED_BYTE;e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t,r,a,u),o(u.width)&&o(u.height)?e.generateMipmap(e.TEXTURE_2D):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR)),i(n)}var i,c,u=new Image;return u.crossOrigin="",u.onload=r,u.onerror=t,u.src=n,new a.a(function(e,n){i=e,c=n})}function o(e){return 0==(e&e-1)}n.a=r;var i=t("//Fk"),a=t.n(i)},fkI9:function(e,n){function t(e){var n=Object.create(null);return{on:function(t,r,o){if("function"!=typeof r)throw new Error("callback is expected to be a function");var i=n[t];return i||(i=n[t]=[]),i.push({callback:r,ctx:o}),e},off:function(t,r){if(void 0===t)return n=Object.create(null),e;if(n[t]){if("function"!=typeof r)delete n[t];else for(var o=n[t],i=0;i<o.length;++i)o[i].callback===r&&o.splice(i,1)}return e},fire:function(t){var r=n[t];if(!r)return e;var o;arguments.length>1&&(o=Array.prototype.splice.call(arguments,1));for(var i=0;i<r.length;++i){var a=r[i];a.callback.apply(a.ctx,o)}return e}}}function r(e){if(!e)throw new Error("Eventify cannot use falsy object as events subject");for(var n=["on","fire","off"],t=0;t<n.length;++t)if(e.hasOwnProperty(n[t]))throw new Error("Subject cannot be eventified, since it already has property '"+n[t]+"'")}e.exports=function(e){r(e);var n=t(e);return e.on=n.on,e.off=n.off,e.fire=n.fire,e}},gIFv:function(e,n,t){"use strict";function r(e){function n(){c.a.off("integration-timestep-changed",a),c.a.off("bbox-change",a),c.a.off("refresh-speed",a),r()}function r(){m&&T.deleteTexture(m),g&&T.deleteTexture(g)}function a(){h&&clearTimeout(h),h=setTimeout(function(){E=!0,h=0},50)}function u(e){T.uniform2f(e.u_velocity_range,P.getMin(),P.getMax())}function l(){r(),y=e.particleStateResolution,b=y*y,_=new Uint8Array(4*b),w=new Uint8Array(4*b),m=i.a.createTexture(T,T.NEAREST,_,y,y),g=i.a.createTexture(T,T.NEAREST,w,y,y),a()}function p(){a()}function v(n){E&&_&&w&&(E=!1,i.a.bindFramebuffer(T,e.framebuffer,m),T.uniform1i(n.u_out_coordinate,d),T.drawArrays(T.TRIANGLES,0,6),T.readPixels(0,0,y,y,T.RGBA,T.UNSIGNED_BYTE,_),i.a.bindFramebuffer(T,e.framebuffer,g),T.uniform1i(n.u_out_coordinate,f),T.drawArrays(T.TRIANGLES,0,6),T.readPixels(0,0,y,y,T.RGBA,T.UNSIGNED_BYTE,w),x())}function x(){P.reset();for(var e=0;e<w.length;e+=4){var n=o(_,e),t=o(w,e),r=Math.sqrt(n*n+t*t);P.add(r)}}var g,m,y,h,b,_,w,E=!0,T=e.gl,P=t.i(s.a)();return function(){c.a.on("integration-timestep-changed",a),c.a.on("bbox-change",a),c.a.on("refresh-speed",a)}(),{updateCode:p,updateParticlesPositions:v,updateParticlesCount:l,setColorMinMax:u,requestSpeedUpdate:a,dispose:n}}function o(e,n){return t.i(u.b)(e[n+0],e[n+1],e[n+2],e[n+3])}n.a=r;var i=t("Ddjs"),a=t("eBcr"),c=t.n(a),u=t("FaU1"),s=t("V39N"),d=6,f=7},h62Y:function(e,n,t){"use strict";function r(e){function n(){o.a.bindFramebuffer(d,e.framebuffer,u),d.viewport(0,0,f.width,f.height),g.boundingBoxUpdated&&p?(l.dx=-(e.bbox.minX-p.minX)/(e.bbox.maxX-e.bbox.minX),l.dy=-(e.bbox.minY-p.minY)/(e.bbox.maxY-e.bbox.minY),l.scale=(e.bbox.maxX-e.bbox.minX)/(p.maxX-p.minX),c(s,e.fadeOpacity,l)):c(s,e.fadeOpacity,i)}function t(){o.a.bindFramebuffer(d,null),a(),d.enable(d.BLEND),d.blendFunc(d.SRC_ALPHA,d.ONE_MINUS_SRC_ALPHA),d.clearColor(v.r,v.g,v.b,v.a),d.clear(d.COLOR_BUFFER_BIT),c(u,1,i),d.disable(d.BLEND);var e=s;s=u,u=e,g.boundingBoxUpdated=!1,window.audioTexture&&c(window.audioTexture,1,i)}function r(){var e=f.width,n=f.height,t=new Uint8Array(e*n*4);u&&d.deleteTexture(u),s&&d.deleteTexture(s),u=o.a.createTexture(d,d.NEAREST,t,e,n),s=o.a.createTexture(d,d.NEAREST,t,e,n)}function a(){if(!p)return void(p={minX:e.bbox.minX,minY:e.bbox.minY,maxX:e.bbox.maxX,maxY:e.bbox.maxY});p.minX=e.bbox.minX,p.minY=e.bbox.minY,p.maxX=e.bbox.maxX,p.maxY=e.bbox.maxY}function c(n,t,r){var i=x;d.useProgram(i.program),o.a.bindAttribute(d,e.quadBuffer,i.a_pos,2),o.a.bindTexture(d,n,e.screenTextureUnit),d.uniform1i(i.u_screen,e.screenTextureUnit),d.uniform1f(i.u_opacity_border,.02),d.uniform1f(i.u_opacity,t),d.uniform3f(i.u_transform,r.dx,r.dy,r.scale),d.drawArrays(d.TRIANGLES,0,6)}var u,s,d=e.gl,f=e.canvasRect,l={dx:0,dy:0,scale:1},p=null,v={r:19/255,g:41/255,b:79/255,a:1};r();var x=o.a.createProgram(d,"// screen program\nprecision highp float;\n\nattribute vec2 a_pos;\nvarying vec2 v_tex_pos;\nuniform vec3 u_transform;\n\nvoid main() {\n    v_tex_pos = a_pos;\n    vec2 pos = a_pos;\n\n    // This transformation tries to move texture (raster) to the approximate position\n    // of particles on the current frame. This is needed to avoid rendering artifacts\n    // during pan/zoom: https://computergraphics.stackexchange.com/questions/5754/fading-particles-and-transition\n\n    // PS: I must admit, I wrote this formula through sweat and tears, and\n    // I still have no idea why I don't need to apply (pos.y - 0.5) to Y coordinate.\n    // Is it because I use aspect ratio for bounding box?\n    pos.x = (pos.x - 0.5) / u_transform.z - u_transform.x + 0.5 * u_transform.z;\n    pos.y = pos.y / u_transform.z + u_transform.y;\n\n    pos = 1.0 - 2.0 * pos;\n    gl_Position = vec4(pos, 0, 1);\n}","precision highp float;\nuniform sampler2D u_screen;\nuniform float u_opacity;\nuniform float u_opacity_border;\n\nvarying vec2 v_tex_pos;\n\nvoid main() {\n  vec2 p = 1.0 - v_tex_pos;\n  vec4 color = texture2D(u_screen, p);\n\n  // For some reason particles near border leave trace when we translate the texture\n  // This is my dirty hack to fix it: https://computergraphics.stackexchange.com/questions/5754/fading-particles-and-transition\n  if (p.x < u_opacity_border || p.x > 1. - u_opacity_border || p.y < u_opacity_border || p.y > 1. - u_opacity_border) {\n    gl_FragColor = vec4(0.);\n  } else {\n    // opacity fade out even with a value close to 0.0\n    gl_FragColor = vec4(floor(255.0 * color * u_opacity) / 255.0);\n  }\n}"),g={fadeOutLastFrame:n,renderCurrentScreen:t,updateScreenTextures:r,boundingBoxUpdated:!1};return g}n.a=r;var o=t("Ddjs"),i={dx:0,dy:0,scale:1}},i69e:function(e,n,t){"use strict";var r=t("Zx67"),o=t.n(r),i=t("Zrlr"),a=t.n(i),c=t("wxAW"),u=t.n(c),s=t("zwoO"),d=t.n(s),f=t("Pf15"),l=t.n(f),p=t("4KA4"),v=function(e){function n(){return a()(this,n),d()(this,(n.__proto__||o()(n)).call(this))}return l()(n,e),u()(n,[{key:"getDefines",value:function(){return"\nuniform float u_h;\n"}},{key:"getFunctions",value:function(){return"\nvec2 rk4(const vec2 point) {\n  vec2 k1 = get_velocity( point );\n  vec2 k2 = get_velocity( point + k1 * u_h * 0.5);\n  vec2 k3 = get_velocity( point + k2 * u_h * 0.5);\n  vec2 k4 = get_velocity( point + k3 * u_h);\n\n  return k1 * u_h / 6. + k2 * u_h/3. + k3 * u_h/3. + k4 * u_h/6.;\n}"}},{key:"getMainBody",value:function(){return"\n  vec2 velocity = rk4(pos);\n"}}]),n}(p.a);n.a=v},iw7m:function(e,n,t){"use strict";function r(e){if(!e)return i.a.reject("Missing link");var n=e.trim();if(!n)return i.a.reject("Missing link");var r=s.get(n);return r?i.a.resolve(r):t.i(u.a)(e).then(function(n){return s.set(e,n),n})}n.a=r;var o=t("//Fk"),i=t.n(o),a=t("ifoU"),c=t.n(a),u=t("C8nW"),s=new c.a},n67P:function(e,n,t){"use strict";function r(){function e(e,n){var t=o.get(e);t&&t.dispose(),o.set(e,n)}function n(e){r=e,o.forEach(t)}function t(e,n){e.updateBinding(r,n)}var r,o=new i.a;return{updateBindings:n,bindInput:e}}n.a=r;var o=t("ifoU"),i=t.n(o)},p0IO:function(e,n,t){"use strict";function r(e,n){var t=0,r=0,o=1;return{applyTransform:function(e){var i=e.x,a=e.y;0==o-e.scale&&Math.abs(i-t)<2.1&&Math.abs(a-r)<2.1||(t=i,r=a,o=e.scale,n(e))},getOwner:function(){return e}}}n.a=r},p2DF:function(e,n,t){"use strict";t("rvz5"),t("Ddjs")},p9aJ:function(e,n,t){"use strict";function r(e){function n(){window.removeEventListener("mousemove",o,!0),window.removeEventListener("mousedown",i,!0),window.removeEventListener("touchstart",t,!0),window.removeEventListener("touchmove",r,!0)}function t(e){var n=e.touches[0];n&&(c(n.clientX,n.clientY),a(n.clientX,n.clientY))}function r(e){var n=e.touches[0];n&&a(n.clientX,n.clientY)}function o(e){a(e.clientX,e.clientY)}function i(e){c(e.clientX,e.clientY)}function a(n,t){e.cursor.hoverX=u(n),e.cursor.hoverY=s(t)}function c(n,t){e.cursor.clickX=u(n),e.cursor.clickY=s(t)}function u(e){var n=(e-d.left)/d.width;return(f.maxX-f.minX)*n+f.minX}function s(e){var n=1-(e-d.top)/d.height;return(f.minY-f.maxY)*n+f.maxY}var d=e.canvasRect,f=e.bbox;return window.addEventListener("mousemove",o,!0),window.addEventListener("mousedown",i,!0),window.addEventListener("touchstart",t,!0),window.addEventListener("touchmove",r,!0),{dispose:n}}n.a=r},pKWO:function(e,n,t){"use strict";function r(e){function n(){y&&y.unload();var n=new i.a(e),t=n.getVertexShader(b);y=o.a.createProgram(h,t,n.getFragmentShader())}function r(){b&&(e.frame+=1,e.frameSeed=Math.random(),m&&m.updateTextures(),_.updateParticlesPositions())}function d(){n()}function f(t){e.frame=0,b=t,_.updateCode(t),n()}function l(){v=e.particleStateResolution,g=v*v;for(var n=new Float32Array(g),r=new Uint8Array(4*g),i=new Uint8Array(4*g),a=e.bbox.minX,u=e.bbox.minY,s=e.bbox.maxX-a,d=e.bbox.maxY-u,f=0;f<g;f++)t.i(c.a)(Math.random()*s+a,r,4*f),t.i(c.a)(Math.random()*d+u,i,4*f),n[f]=f;x&&h.deleteBuffer(x),x=o.a.createBuffer(h,n),_.updateParticlesCount(r,i)}function p(){if(b){var n=y;h.useProgram(n.program),o.a.bindAttribute(h,x,n.a_index,1),_.prepareToDraw(n),e.inputs.updateBindings(n),h.uniform1f(n.u_h,e.integrationTimeStep),h.uniform1f(n.frame,e.frame),h.uniform1f(n.u_particles_res,v);var t=e.bbox;h.uniform2f(n.u_min,t.minX,t.minY),h.uniform2f(n.u_max,t.maxX,t.maxY);var r=e.cursor;h.uniform4f(n.cursor,r.clickX,r.clickY,r.hoverX,r.hoverY),h.drawArrays(h.POINTS,0,g)}}var v,x,g,m,y,h=e.gl,b="",_=t.i(a.a)(e);return function(){n(),u.a.isAudioEnabled&&(m&&m.dispose(),m=t.i(s.a)(e))}(),{updateParticlesCount:l,updateParticlesPositions:r,drawParticles:p,updateCode:f,updateColorMode:d}}n.a=r;var o=t("Ddjs"),i=t("aZPT"),a=t("3xg8"),c=t("FaU1"),u=t("rvz5"),s=t("94y8")},pXNl:function(e,n,t){"use strict";function r(e,n,t){function r(n){c.forEach(function(t){e.uniform1i(n["u_particles_"+t.name],t.index)})}function i(){c.forEach(function(n){return e.deleteTexture(n.texture)})}function a(e,n){c.forEach(function(t){o.a.bindTexture(e,t.texture,t.index),e.uniform1i(n["u_particles_"+t.name],t.index)})}var c=n.map(function(n,r){return{texture:o.a.createTexture(e,e.NEAREST,n.particleState,t,t),index:r,name:n.name}});return{dispose:i,bindTextures:a,assignProgramUniforms:r,length:n.length,textures:c,get:function(e){return c[e]}}}n.a=r;var o=t("Ddjs")},rvz5:function(e,n,t){"use strict";var r=t("NEgR"),o={isAudioEnabled:!1,vectorLinesEnabled:!1,FREE_TEXTURE_UNIT:4,showBindings:r.a.getQS().get("showBindings")||!1};n.a=o},sbZs:function(e,n,t){"use strict";function r(e){x=e;var n=f.a.getQS().get("auto");if(n){var t=parseInt(n,10);return d()(t)?void console.error("malformed auto param; not a number"):(t<=500&&(console.warn("auto param is too small; defaulting to 30"),t=3e4),p=t,g=setTimeout(i,p),o)}}function o(){clearTimeout(g),g=0}function i(){v&&v.length||(v=l.a.slice());var e=v.shift();x.vectorFieldEditorState.setCode(e.code),a(e.colorMode)&&x.setColorMode(e.colorMode),a(e.timeStep)&&x.setIntegrationTimeStep(e.timeStep),a(e.fadeOut)&&x.setFadeOutSpeed(e.fadeOut),a(e.dropProbability)&&x.setDropProbability(e.dropProbability),a(e.particleCount)&&x.setParticlesCount(e.particleCount);var n=f.a.makeBBox(e.cx,e.cy,e.w,e.h);n&&x.moveBoundingBox(n),g=setTimeout(i,p)}function a(e){return u()(e)}n.a=r;var c=t("AMV0"),u=t.n(c),s=t("MICi"),d=t.n(s),f=t("NEgR"),l=t("7QEO"),p=void 0,v=void 0,x=void 0,g=void 0},svlg:function(e,n,t){"use strict";function r(e){if(!e)return new a.a(function(e){return e(s)});var n=o(e);return n.pending.length>0?a.a.all(n.pending).then(function(){return n}).catch(function(e){return{error:{error:e}}}):new a.a(function(e){return e(n)})}function o(e){function n(){return a.join("\n")}function r(e){if(0===e.indexOf(u)){var n=e.substr(u.length),r=s;o.push(t.i(c.a)(n).then(function(e){a[r]=e}))}}var o=[],i=e.split("\n"),a=[],s=0;return i.forEach(function(e,n){s=n,e&&"#"===e[0]?(a.push(""),r(e)):a.push(e)}),{getCode:n,pending:o}}n.a=r;var i=t("//Fk"),a=t.n(i),c=t("iw7m"),u="#include ",s={code:""}},vhRe:function(e,n,t){"use strict";var r=t("Zx67"),o=t.n(r),i=t("Zrlr"),a=t.n(i),c=t("wxAW"),u=t.n(c),s=t("zwoO"),d=t.n(s),f=t("Pf15"),l=t.n(f),p=t("4KA4"),v=function(e){function n(e){a()(this,n);var t=d()(this,(n.__proto__||o()(n)).call(this));return t.decode=e&&e.decode,t.srcPosName=e&&e.posName||"pos",t}return l()(n,e),u()(n,[{key:"getDefines",value:function(){if(this.decode)return"\n  uniform vec2 u_min;\n  uniform vec2 u_max;\n"}},{key:"getMainBody",value:function(){return this.decode?"\n  // move particle position according to current transform\n  vec2 du = (u_max - u_min);\n  pos.x = "+this.srcPosName+".x * du.x + u_min.x;\n  pos.y = "+this.srcPosName+".y * du.y + u_min.y;\n":"\n  pos.x = ("+this.srcPosName+".x - u_min.x)/du.x;\n  pos.y = ("+this.srcPosName+".y - u_min.y)/du.y;\n"}}]),n}(p.a);n.a=v}},["YJWA"]);
//# sourceMappingURL=app.08c224629ad8b567fa94.js.map